import{a as h,b,d as F,e as u,f as D,g as l,h as A,j as O,k as w,l as I}from"./chunk-TPBQQWXI.js";import{I as p}from"./chunk-A6BW764O.js";import{R as g,W as d,a as c,b as v,ma as f,o as r,t as m}from"./chunk-KTUCGMTK.js";var y=class n{firestore=d(b);authService=d(p);favorites=f([]);loading=f(!1);addFavorite(e,t,o){let s=this.authService.currentUser();if(!s)throw new Error("Usuario no autenticado");let i={nombre:e,customName:o||e,image:t,userId:s.uid,createdAt:new Date},a=u(this.firestore,"favorites");return r(F(a,v(c({},i),{createdAt:h.fromDate(i.createdAt)})))}getFavorites(){let e=this.authService.currentUser();if(!e)return r([[]]);this.loading.set(!0);let t=u(this.firestore,"favorites"),o=O(t,I("userId","==",e.uid));return r(A(o)).pipe(m(s=>{let i=s.docs.map(a=>v(c({id:a.id},a.data()),{createdAt:a.data().createdAt.toDate()}));return this.favorites.set(i),this.loading.set(!1),i}))}updateFavorite(e,t){let o=l(this.firestore,"favorites",e);return r(w(o,{customName:t}))}deleteFavorite(e){let t=l(this.firestore,"favorites",e);return r(D(t))}isFavorite(e){return this.favorites().some(t=>t.nombre===e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=g({token:n,factory:n.\u0275fac,providedIn:"root"})};export{y as a};
